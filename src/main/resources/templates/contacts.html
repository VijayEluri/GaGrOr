<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="/fragments/framework :: head" />
<body>
	<div th:replace="/fragments/mainmenu :: mainmenu"></div>
	<h1>Contacts</h1>
	<p th:if="${#lists.isEmpty(contacts)}">You have no contacts</p>
	<table th:fragment="contactTable (contacts)" th:unless="${#lists.isEmpty(contacts)}">
		<thead>
			<tr>
				<td>Username</td>
				<td>Account type</td>
				<td>Registered</td>
				<td>Actions</td>
			</tr>
		</thead>
		<tbody>
			<tr th:each="contact : ${contacts}">
				<td class="fi-torso" th:class="#{${contact.cssClass}}" th:text="${contact.username}">Name</td>
				<td th:text="#{${contact.accountType.displayNameProperty}}">Standard user</td>
				<td th:text="${#calendars.format(contact.created,'yyyy-MM-dd HH:mm')}">1970-01-01 00:01</td>
				<td>
					<ul>
						<li th:if="${contact.contactType} ? ${contact.contactType.contact}">
							<a href="view_contact.html" th:href="@{/account/viewcontact/{contactId}(contactId=${contact.contactId})}">View contact</a>
						</li>
						<li th:if="${#lists.contains(currentUser.accountType.mayEdit, contact.accountType)}">
							<a href="edit_account.html" th:href="@{/account/edit/{accountId}(accountId=${contact.id})}">Edit account</a>
						</li>
						<li th:if="${#lists.contains(currentUser.accountType.mayEdit, contact.accountType)}">
							<a href="#" th:href="@{/account/login/{accountId}(accountId=${contact.id})}">Log in as user</a>
						</li>
					</ul>
				</td>
			</tr>
		</tbody>
	</table>
	<h2 th:unless="${#lists.isEmpty(sentContactRequests)}">Sent contact requests</h2>
	<table th:replace=":: contactTable (contacts=${sentContactRequests})"></table>
	<h2 th:unless="${#lists.isEmpty(receivedContactRequests)}">Received contact requests</h2>
	<table th:replace=":: contactTable (contacts=${receivedContactRequests})"></table>
	<h2>Other users</h2>
	<p th:if="${#lists.isEmpty(notMyContacts)}">All users are your contacts</p>
	<table th:replace=":: contactTable (contacts=${notMyContacts})"></table>
	<script th:replace="/fragments/framework :: init"></script>
</body>
</html>
